new FastClick(document.body);var it=0,itAll=0,cubesRight=!1;document.ontouchmove=function(t){t.preventDefault()},App=Ember.Application.create(),App.Router.map(function(){this.route("intro"),this.route("form"),this.route("pre"),this.route("test"),this.route("result")}),App.IndexRoute=Em.Route.extend({redirect:function(){this.transitionTo("intro")}}),App.IntroRoute=Em.Route.extend({model:function(){return this.store.find("corsi",1)}}),App.FormRoute=Em.Route.extend({model:function(){return this.store.find("corsi",1)}}),App.PreRoute=Em.Route.extend({model:function(){return this.store.find("corsi",1)}}),App.TestRoute=Em.Route.extend({model:function(){return this.store.find("corsi",1)}}),App.ResultRoute=Em.Route.extend({model:function(){return this.store.find("corsi",1)}}),App.IntroView=Em.View.extend({didInsertElement:function(){this.get("controller").setProperties({testCom:require("electron").remote.getGlobal("sharedObject").someProperty,timeDateIni:(new Date).toLocaleTimeString(),timeDateFin:"",level:1,cubes:2,clicks:0,tapErrors:0,errCount:0})},touchEnd:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("form")},click:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("form")}}),App.FormView=Em.View.extend({d:"",didInsertElement:function(){this.d=this.get("controller")},touchEnd:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("test")},click:function(t){this.d.setProperties({participant:$("#participant").val(),experimenter:$("#experimenter").val()}),"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("test")}}),App.PreView=Em.View.extend({didInsertElement:function(){for(var t=this.get("controller.level"),e=1;t>=e;)this.$("#small-btn-"+e).addClass("btn-flash"),e+=1;this.get("controller").transitionToRoute("test"),cubesRight=!1},willDestroyElement:function(){this.$(".small-btns").find(".btn").removeClass("btn-flash")},touchEnd:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("test")},click:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("test")}}),App.ResultView=Em.View.extend({didInsertElement:function(){var t=this.get("controller");t.setProperties({timeDateFin:(new Date).toLocaleTimeString(),totalCorrectTrial:itAll,totalScore:(t.get("level")-1)*itAll}),this.set("controller.level",this.get("controller.level")-1),require("electron").remote.getGlobal("sharedObject").makeCSV(["ola"])},touchEnd:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("intro")},click:function(t){"BUTTON"===t.target.nodeName&&this.get("controller").transitionToRoute("intro")}}),App.TestView=Em.View.extend({previousTouchId:0,willDestroyElement:function(){this.get("controller").setProperties({clicks:0,tapErrors:0}),this.set("previousTouchId",0),this.$(".test-btns").toggleClass("animation play"),this.$(".btn").removeClass("btn-flash-show btn-flash btn-danger"),this.$(".message").empty()},didInsertElement:function(){this.setElements(),$("#btn-test").hide(),$("#msg-test").show()},setElements:function(){var t=this,e=_.shuffle(_.first(_.shuffle(randomGrids)));t.$(".test-btns").addClass("animation"),t.$(".screen").removeClass("hidden"),e.forEach(function(e,n){t.$("#btn-"+(n+1)).css({left:e.left,top:e.top,visibility:"visible"})}),Ember.run.next(function(){setTimeout(function(){t.flashElements()},800)})},flashElements:function(){var t=this.get("controller").get("cubes"),e=1,n=this;$("#btn-test").hide(),$("#msg-test").hide(),$(".message").html("<strong>Esperar</strong>");var o=setInterval(function(){var r=n.$("#btn-"+e);r.addClass("btn-flash"),setTimeout(function(){r.removeClass("btn-flash")},800),e>=t&&(clearInterval(o),setTimeout(function(){n.$(".test-btns").toggleClass("animation play"),n.$(".screen").addClass("hidden"),$("#btn-test").show(),$(".message").html("<strong>Hecho</strong>")},2e3)),e+=1},1300)},touchEnd:function(t){this.eventChannel(t)},click:function(t){this.eventChannel(t)},eventChannel:function(t){var e=$(t.target),n=this.get("controller"),o=e.text();"Hecho"===o?this.testEvent(o):(n.set("clicks",n.get("clicks")+1),this.testEvent(o))},testEvent:function(t){var e=this,n=1,o=e.get("controller"),r=o.get("clicks"),s=o.get("cubes"),i=o.get("tapErrors"),l=o.get("errCount");if(r!=t&&"Hecho"!==t?(o.set("tapErrors",i+1),e.$("#btn-"+r).addClass("error")):r===s&&(cubesRight=!0),"Hecho"!==t||cubesRight||(o.set("tapErrors",i+1),e.$("#btn-"+r).addClass("error")),"Hecho"===t){for($("#btn-test").hide(),n=1;s>=n;)e.$("#btn-"+n).addClass("btn-flash-show"),n+=1;cubesRight&&0===o.get("tapErrors")?$(".message").html("<strong>Correcto</strong>"):(o.get("errCount"),$(".message").html("<strong> Incorrecto</ strong>")),$("#msg-test").show(),setTimeout(function(){0!==o.get("tapErrors")&&(l+=1,o.set("errCount",l)),itAll++,++it>1&&(o.set("errCount",0),o.set("cubes",s+1),o.set("level",s),it=0),l>1||o.get("level")>=10?o.transitionToRoute("result"):o.transitionToRoute("pre")},1200)}}}),Em.Handlebars.registerBoundHelper("multiply",function(t,e){return t>1?e+"ta":e}),App.ApplicationAdapter=DS.FixtureAdapter,App.Corsi=DS.Model.extend({participant:DS.attr("string"),experimenter:DS.attr("string"),timeDateIni:DS.attr("date"),timeDateFin:DS.attr("date"),totalScore:DS.attr("number"),totalCorrectTrial:DS.attr("number"),cubes:DS.attr("number"),level:DS.attr("number"),clicks:DS.attr("number"),tapErrors:DS.attr("number"),errCount:DS.attr("number")}),App.Corsi.FIXTURES=[{id:1,level:1,clicks:0,tapErrors:0,errCount:0}];var randomGrids=[[{top:68,left:43},{top:391,left:298},{top:32,left:299},{top:19,left:628},{top:188,left:562},{top:360,left:56},{top:214,left:211},{top:227,left:389},{top:370,left:614}]];